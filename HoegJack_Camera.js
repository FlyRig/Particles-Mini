function Camera(){this.camType=1,this.fov=glMatrix.glMatrix.toRadian(40),this.upV=glMatrix.vec3.fromValues(0,0,1),glMatrix.vec3.normalize(this.upV,this.upV),this.panPoint=3.725,this.panStep=.02,this.tiltPoint=30.209,this.tiltStep=.015,this.eyePoint=glMatrix.vec3.fromValues(80.579,47.326,30.112),this.lookPoint=glMatrix.vec3.fromValues(this.eyePoint[0]+Math.cos(this.panPoint),this.eyePoint[1]+Math.sin(this.panPoint),this.tiltPoint),this.dollySpeed=.3,this.znear=.01,this.zfar=600,this.zdist=(this.zfar-this.znear)/3,this.perAspect,this.halfHeight=this.zdist*Math.tan(Math.PI/9),this.halfWidth=this.halfHeight*this.perAspect,this.changed=!0,this.viewMat=glMatrix.mat4.create(),this.projMat=glMatrix.mat4.create(),this.vp=glMatrix.mat4.create(),this.mvp=glMatrix.mat4.create()}Camera.prototype.init=function(){this.refreshAspect(),this.refreshView(),this.refreshVP()},Camera.prototype.camStart=function(t){glMatrix.mat4.identity(t),glMatrix.mat4.multiply(t,t,this.vp)},Camera.prototype.changeType=function(){this.camType=!this.camType,this.refreshProj()},Camera.prototype.refreshAspect=function(){this.perAspect=g_canvas.width/g_canvas.height,this.refreshProj()},Camera.prototype.refreshView=function(){glMatrix.mat4.lookAt(this.viewMat,this.eyePoint,this.lookPoint,this.upV),this.changed=!0},Camera.prototype.refreshProj=function(){this.camType?glMatrix.mat4.perspective(this.projMat,this.fov,this.perAspect,this.znear,this.zfar):(this.halfWidth=this.halfHeight*this.perAspect,glMatrix.mat4.ortho(this.projMat,-this.halfWidth,this.halfWidth,-this.halfHeight,this.halfHeight,this.znear,this.zfar)),this.changed=!0},Camera.prototype.refreshVP=function(){this.vp=glMatrix.mat4.clone(this.projMat),glMatrix.mat4.multiply(this.vp,this.vp,this.viewMat),this.changed=!1,this.refreshMVP()},Camera.prototype.refreshMVP=function(){glMatrix.mat4.identity(this.mvp),glMatrix.mat4.multiply(this.mvp,this.mvp,this.vp)},Camera.prototype.getForwardDir=function(){var t=glMatrix.vec3.create();return glMatrix.vec3.sub(t,this.lookPoint,this.eyePoint),glMatrix.vec3.normalize(t,t),t},Camera.prototype.getSideDir=function(){var t=glMatrix.vec3.create();return glMatrix.vec3.sub(t,this.lookPoint,this.eyePoint),glMatrix.vec3.cross(t,t,this.upV),glMatrix.vec3.normalize(t,t),t},Camera.prototype.dollyForward=function(){var t=glMatrix.vec3.create();glMatrix.vec3.sub(t,this.lookPoint,this.eyePoint),glMatrix.vec3.normalize(t,t),glMatrix.vec3.scale(t,t,this.dollySpeed),glMatrix.vec3.add(this.eyePoint,this.eyePoint,t),glMatrix.vec3.add(this.lookPoint,this.lookPoint,t),this.tiltPoint=this.lookPoint[2],glMatrix.vec3.negate(t,t),glMatrix.mat4.translate(this.viewMat,this.viewMat,t),this.changed=!0},Camera.prototype.dollyBack=function(){var t=glMatrix.vec3.create();glMatrix.vec3.sub(t,this.lookPoint,this.eyePoint),glMatrix.vec3.normalize(t,t),glMatrix.vec3.scale(t,t,-this.dollySpeed),glMatrix.vec3.add(this.eyePoint,this.eyePoint,t),glMatrix.vec3.add(this.lookPoint,this.lookPoint,t),this.tiltPoint=this.lookPoint[2],glMatrix.vec3.negate(t,t),glMatrix.mat4.translate(this.viewMat,this.viewMat,t),this.changed=!0},Camera.prototype.strafeLeft=function(){var t=glMatrix.vec3.create();glMatrix.vec3.sub(t,this.lookPoint,this.eyePoint),glMatrix.vec3.cross(t,t,this.upV),glMatrix.vec3.normalize(t,t),glMatrix.vec3.scale(t,t,-this.dollySpeed),glMatrix.vec3.add(this.eyePoint,this.eyePoint,t),glMatrix.vec3.add(this.lookPoint,this.lookPoint,t),glMatrix.vec3.negate(t,t),glMatrix.mat4.translate(this.viewMat,this.viewMat,t),this.changed=!0},Camera.prototype.strafeRight=function(){var t=glMatrix.vec3.create();glMatrix.vec3.sub(t,this.lookPoint,this.eyePoint),glMatrix.vec3.cross(t,t,this.upV),glMatrix.vec3.normalize(t,t),glMatrix.vec3.scale(t,t,this.dollySpeed),glMatrix.vec3.add(this.eyePoint,this.eyePoint,t),glMatrix.vec3.add(this.lookPoint,this.lookPoint,t),glMatrix.vec3.negate(t,t),glMatrix.mat4.translate(this.viewMat,this.viewMat,t),this.changed=!0},Camera.prototype.tiltUp=function(){this.tiltPoint+=this.tiltStep,this.lookPoint[2]=this.tiltPoint},Camera.prototype.tiltDown=function(){this.tiltPoint-=this.tiltStep,this.lookPoint[2]=this.tiltPoint},Camera.prototype.panLeft=function(){this.panPoint+=this.panStep,this.lookPoint[0]=this.eyePoint[0]+Math.cos(this.panPoint),this.lookPoint[1]=this.eyePoint[1]+Math.sin(this.panPoint)},Camera.prototype.panRight=function(){this.panPoint-=this.panStep,this.lookPoint[0]=this.eyePoint[0]+Math.cos(this.panPoint),this.lookPoint[1]=this.eyePoint[1]+Math.sin(this.panPoint)},Camera.prototype.craneUp=function(){this.eyePoint[2]+=this.dollySpeed,this.lookPoint[2]+=this.dollySpeed,this.tiltPoint=this.lookPoint[2];var t=glMatrix.vec3.clone(this.upV),t=glMatrix.vec3.scale(t,t,-this.dollySpeed);glMatrix.mat4.translate(this.viewMat,this.viewMat,t),this.changed=!0},Camera.prototype.craneDown=function(){this.eyePoint[2]-=this.dollySpeed,this.lookPoint[2]-=this.dollySpeed,this.tiltPoint=this.lookPoint[2];var t=glMatrix.vec3.clone(this.upV),t=glMatrix.vec3.scale(t,t,this.dollySpeed);glMatrix.mat4.translate(this.viewMat,this.viewMat,t),this.changed=!0};